# 保持与官方仓库同步指南

## 概述

本指南提供两种方式保持 fork 仓库与官方仓库同步：**自动化脚本**（推荐）和**手动操作**。

## 方式一：自动化脚本（推荐）

### 快速使用

**1. 配置脚本变量**（首次使用修改脚本顶部）：

```bash
UPSTREAM_REPO_URL="https://github.com/jeecgboot/JeecgBoot.git"
ORIGIN_REPO_URL="https://github.com/your-username/JeecgBoot.git"
MAIN_BRANCH="master"
PERSONAL_BRANCH="my-custom"
```

**2. 运行脚本**：

```bash
# Windows: sync-with-upstream.bat
# Linux/Mac: ./sync-with-upstream.sh
```

### 脚本功能

- ✅ 自动检查 Git 仓库状态和配置
- ✅ 同步主分支与上游仓库
- ✅ 更新个人分支（支持 Rebase/Merge 选择）
- ✅ 自动创建备份分支防止数据丢失
- ✅ 详细的中文操作总结报告
- ✅ 智能冲突处理指导

## 方式二：手动操作

### 基本流程

| 步骤            | 命令                                                                                               | 说明             |
| --------------- | -------------------------------------------------------------------------------------------------- | ---------------- |
| 1. 添加上游仓库 | `git remote add upstream https://github.com/jeecgboot/JeecgBoot.git`                               | 只需执行一次     |
| 2. 同步主分支   | `git checkout master && git fetch upstream && git merge upstream/master && git push origin master` | 更新 master 分支 |
| 3. 更新个人分支 | `git checkout my-custom && git rebase master`                                                      | 推荐 rebase 方式 |

**替代方案**：如果 rebase 冲突复杂，使用 `git merge master`

## 冲突处理

**Rebase 冲突**：

```bash
git add <冲突文件>
git rebase --continue
# 或放弃：git rebase --abort
```

**Merge 冲突**：

```bash
git add <冲突文件>
git commit
```

## 最佳实践

- 🔄 **定期同步**：建议每周执行一次
- 📝 **小而频繁的提交**：减少冲突复杂度
- 💾 **操作前备份**：`git checkout -b my-custom-backup`
- 🧪 **同步后测试**：确保功能正常

## 常见问题

| 问题         | 解决方案                                             |
| ------------ | ---------------------------------------------------- |
| 网络连接失败 | 检查网络或使用 VPN                                   |
| 权限不足     | 检查 SSH 密钥或使用 HTTPS                            |
| 分支不存在   | 检查分支名称配置                                     |
| 误操作回滚   | `git reflog` 查找提交哈希，`git reset --hard <hash>` |

## 注意事项

- ⚠️ rebase 前建议创建备份分支
- ⚠️ 已推送分支 rebase 后需要 `git push --force-with-lease`
- ⚠️ 团队协作优先使用 merge
- ⚠️ 定期清理分支：`git branch -d <分支名>`
